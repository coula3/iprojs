<br>
<h2>My Dashboard</h2>

<div style="padding-left:15px">
    <table style="width:60%; margin-top:20px">
        <thead>
            <tr>
                <th style="text-align:left; padding: 0px"></th>
                <th style="text-align:center; padding: 0px"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Total Projects</td>
                <td><a href="/projects" title="Projects"><%= current_user.projects.size.to_words.titlecase %> (<%= current_user.projects.size %>)</a></td>
            </tr>
            <tr class="spacer"></tr>
            <tr>
                <td>Phase</td>
                <td>Planning</td>
                <td><%= current_user.projects.where(phase: "Planning").size > 0 ? current_user.projects.where(phase: "Planning").size : "-" %></td>
            </tr>
            <tr>
                <td></td>
                <td>Development</td>
                <td><%= current_user.projects.where(phase: "Development").size > 0 ? current_user.projects.where(phase: "Development").size : "-" %></td>
            </tr>
            <tr>
                <td></td>
                <td>Testing</td>
                <td><%= current_user.projects.where(phase: "Testing").size > 0 ? current_user.projects.where(phase: "Testing").size : "-" %></td>
            </tr>
            <tr>
                <td></td>
                <td>Completed</td>
                <td><%= current_user.projects.where(phase: "Completed").size > 0 ? current_user.projects.where(phase: "Completed").size : "-" %></td>
            </tr>
            <tr>
                <td></td>
                <td>Production</td>
                <td><%= current_user.projects.where(phase: "Production").size > 0 ? current_user.projects.where(phase: "Production").size  : "-" %></td>
            </tr>
            <tr class="spacer"></tr>
            <% if @user.projects.any? {|p| p.actual_end_date} %>
                <tr>
                    <td>On-Time Completion</td>
                    <td><a href="/project_dates_analysis" title="Project Completion Analysis"><%= @rate_of_timely_completion%>%</a></td>
                </tr>
                <tr class="spacer"></tr>
            <% end %>
            <tr>
                <td>Last Project Registered</td>
                <td>Title</td>
                <td><a href="/projects/<%= @last_project_created.slug %>" title="Date last project created"><%= @last_project_created.title %></a></td>
            </tr>
            <tr>
                <td></td>
                <td>Date</td>
                <td><%= current_user.projects.map(&:created_at).sort.last.strftime("%b %d, %Y") %></td>
            </tr>
            <tr>
                <td></td>
                <td>Phase</td>
                <td><%= current_user.projects.sort_by {|p| p.created_at}.last.phase %></td>
            </tr>
            <tr class="spacer"></tr>
            <tr>
                <td>Last Project Edited</td>
                <td>Title</td>
                <td><a href="/projects/<%= @last_project_updated.slug%>" title="Date last project updated"><%=@last_project_updated.title%></a></td>
            </tr>
            <tr>
                <td></td>
                <td>Date & Time</td>
                <td><%= ((current_user.projects.map(&:updated_at).sort.last)- 60*60*4).strftime("%b %d, %Y %H:%M:%S") %></td>
            </tr>
            <tr>
                <td></td>
                <td>Phase</td>
                <td><%= current_user.projects.sort_by {|p| p.updated_at}.last.phase %></td>
            </tr>
        </tbody>
    </table>
</div>